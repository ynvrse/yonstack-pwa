import{j as e}from"./theme-provider-BLIrfkjI.js";import{d as n,r as i,a as c}from"./App-DteNmcQd.js";import"./index-DVYklf_w.js";function b(){const{isLoading:t,error:s,data:r}=n.useQuery({todos:{}}),{peers:o}=n.rooms.usePresence(i),l=1+Object.keys(o).length;if(t)return;if(s)return e.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",s.message]});const{todos:a}=r;return e.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center space-y-4 font-mono",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Number of users online: ",l]}),e.jsx("h2",{className:"text-5xl tracking-wide text-gray-300",children:"todos"}),e.jsxs("div",{className:"w-full max-w-xs border border-gray-300",children:[e.jsx(p,{todos:a}),e.jsx(j,{todos:a}),e.jsx(g,{todos:a})]}),e.jsx("div",{className:"text-center text-xs",children:"Open another tab to see todos update in realtime!"})]})}function d(t){n.transact(n.tx.todos[c()].update({text:t,done:!1,createdAt:Date.now()}))}function x(t){n.transact(n.tx.todos[t.id].delete())}function u(t){n.transact(n.tx.todos[t.id].update({done:!t.done}))}function m(t){const r=t.filter(o=>o.done).map(o=>n.tx.todos[o.id].delete());n.transact(r)}function f(t){const s=!t.every(r=>r.done);n.transact(t.map(r=>n.tx.todos[r.id].update({done:s})))}function h(){return e.jsx("svg",{viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 8 L10 13 L15 8",stroke:"currentColor",fill:"none",strokeWidth:"2"})})}function p({todos:t}){return e.jsxs("div",{className:"flex h-10 items-center border-b border-gray-300",children:[e.jsx("button",{className:"flex h-full items-center justify-center border-r border-gray-300 px-2",onClick:()=>f(t),children:e.jsx("div",{className:"h-5 w-5",children:e.jsx(h,{})})}),e.jsx("form",{className:"h-full flex-1",onSubmit:s=>{s.preventDefault();const r=s.currentTarget.input;d(r.value),r.value=""},autoComplete:"off",children:e.jsx("input",{className:"h-full w-full bg-transparent px-2 outline-none",autoFocus:!0,placeholder:"What needs to be done?",type:"text",autoComplete:"off",name:"input"})})]})}function j({todos:t}){return e.jsx("div",{className:"divide-y divide-gray-300",children:t.map(s=>e.jsxs("div",{className:"flex h-10 items-center",children:[e.jsx("div",{className:"flex h-full items-center justify-center px-2",children:e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:e.jsx("input",{type:"checkbox",className:"cursor-pointer",checked:s.done,onChange:()=>u(s)})})}),e.jsx("div",{className:"flex flex-1 items-center overflow-hidden px-2",children:s.done?e.jsx("span",{className:"line-through",children:s.text}):e.jsx("span",{children:s.text})}),e.jsx("button",{className:"flex h-full items-center justify-center px-2 text-gray-300 hover:text-gray-500",onClick:()=>x(s),children:"X"})]},s.id))})}function g({todos:t}){return e.jsxs("div",{className:"flex h-10 items-center justify-between border-t border-gray-300 px-2 text-xs",children:[e.jsxs("div",{children:["Remaining todos: ",t.filter(s=>!s.done).length]}),e.jsx("button",{className:"text-gray-300 hover:text-gray-500",onClick:()=>m(t),children:"Delete Completed"})]})}export{b as default};
